<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vehicle Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f4f4f4;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    #map {
      height: 500px;
      width: 100%;
      margin-top: 20px;
      border: 2px solid #333;
      border-radius: 8px;
    }
    #output {
      margin-top: 15px;
      padding: 10px;
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 6px;
      min-height: 40px;
    }
    button {
      display: block;
      margin: 0 auto;
      padding: 10px 20px;
      background: #007bff;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>
  <h1>üöó Vehicle Tracker</h1>
  <button id="speakBtn">üé§ Speak</button>
  <div id="output">Say something like "Find vehicle Toyota" or "Where is vehicle 1".</div>
  <div id="map"></div>

  <script>
    // Mock vehicle data with assigned drivers
    const mockVehicles = {
      "vehicle 1": { lat: 37.7749, lng: -122.4194, driver: "Ramesh", location: "San Francisco" },
      "vehicle 2": { lat: 34.0522, lng: -118.2437, driver: "Suresh", location: "Los Angeles" },
      "toyota": { lat: 40.7128, lng: -74.0060, driver: "Mahesh", location: "New York" },
    };

    let map, marker;

    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        center: { lat: 20.5937, lng: 78.9629 }, // Center of India
        zoom: 4,
      });
    }

    function showOnMap(vehicleName, details) {
      if (marker) marker.setMap(null); // clear old marker
      marker = new google.maps.Marker({
        position: { lat: details.lat, lng: details.lng },
        map: map,
        title: `${vehicleName} - Driver: ${details.driver}`,
      });
      map.setCenter({ lat: details.lat, lng: details.lng });
      map.setZoom(8);
      document.getElementById("output").textContent =
        `‚úÖ ${vehicleName} is in ${details.location}, driven by ${details.driver}.`;
    }

    document.getElementById("speakBtn").addEventListener("click", () => {
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = "en-US";
      recognition.start();

      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript.toLowerCase();
        document.getElementById("output").textContent = `üé§ You said: ${transcript}`;

        // Keyword check
        let found = false;
        for (let key in mockVehicles) {
          if (transcript.includes(key)) {
            showOnMap(key, mockVehicles[key]);
            found = true;
            break;
          }
        }

        // Check by location keyword
        if (!found) {
          for (let key in mockVehicles) {
            if (transcript.includes(mockVehicles[key].location.toLowerCase())) {
              showOnMap(key, mockVehicles[key]);
              found = true;
              break;
            }
          }
        }

        if (!found) {
          document.getElementById("output").textContent =
            "‚ö†Ô∏è Could not understand. Try saying a vehicle or location name.";
        }
      };
    });
  </script>

  <!-- Google Maps JS API -->
  <script async
    src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&callback=initMap">
  </script>
</body>
</html>
